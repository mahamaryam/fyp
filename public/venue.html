<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Wedding Wiz</title>

    <!-- Stylesheets & Fonts -->
    <link href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poiret+One&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" />

    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding-top: 80px;
            margin: 0;
        }

        #text {
            font-size: 300px !important;
            margin-bottom: 20px;
            color: white;
            background: radial-gradient(circle, rgba(0, 0, 0, 0.7) 10%, rgba(0, 0, 0, 0) 70%);
            text-shadow: 7px 7px 10px rgba(0, 0, 0, 0.8);
            padding: 20px 30px;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.9);
            display: inline-block;
            opacity: 0.9;
        }

        #stickyButton {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            padding: 10px 30px;
            font-size: 30px;
            height: 80px;
            background-color: #6648b1;
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
            transition: background-color 0.3s ease;
        }

        #stickyButton:hover {
            background-color: #0056b3;
        }

        .carousel-caption {
            bottom: 10%;
            left: 50%;
            transform: translateX(-50%);
        }

        .toggleButton {
            position: absolute;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
        }
    </style>
</head>

<body>

    <!-- Scroll Up Button -->
    <div class="up">
        <a href="#carouselExampleCaptions"><button><i class="fas fa-chevron-up"></i></button></a>
    </div>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <img src="img/logo.png" alt="" style="width: 60px; height: 50px; margin-right: 10px;" />
                Wedding Wiz
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent">
                <span><i class="fad fa-bars"></i></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav" id="nav-content">
                    <li class="nav-item"><a class="nav-link active" href="#carouselExampleCaptions">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="#about">About</a></li>
                    <li class="nav-item"><a class="nav-link" href="#ser">Services</a></li>
                    <li class="nav-item"><a class="nav-link" href="#team">Gallery</a></li>
                    <li class="nav-item"><a class="nav-link" href="#contact">Contact</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div id="stars"></div>

    <!-- User Profile -->
    <div class="container mt-4" id="user-profile">
        <h3>User Profile</h3>
        <div id="user-info" class="card p-3 shadow-sm">
            Loading profile...
        </div>
    </div>

    <!-- Carousel -->
    <div id="carouselExampleCaptions" class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-indicators">
            <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="0"
                class="active"></button>
            <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="1"></button>
            <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="2"></button>
        </div>
        <div class="carousel-inner">
            <div class="carousel-item active">
                <div class="im4"></div>
                <div class="carousel-caption">
                    <div class="text">Welcome to Wedding Wiz!</div>
                    <button class="toggleButton">Hide Text</button>
                </div>
            </div>
            <div class="carousel-item">
                <div class="im5"></div>
                <div class="carousel-caption">
                    <div class="text">Capture Your Moment</div>
                    <button class="toggleButton">Hide Text</button>
                </div>
            </div>
            <div class="carousel-item">
                <div class="im6"></div>
                <div class="carousel-caption">
                    <div class="text">Elegant Wedding Planning</div>
                    <button class="toggleButton">Hide Text</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Customer Reviews -->
    <div class="container-fluid padding" id="venues" style="margin: 40px 0;">
        <div class="row welcome text-center">
            <div class="col-12">
                <h1 class="display-4" data-aos="fade-down">Customer Reviews</h1>
                <hr>
            </div>
        </div>
    </div>

    <div class="container mt-5 mb-5">
        <div class="row justify-content-center gx-2 gy-3">
            <!-- Repeatable Review Cards -->
            <!-- ... [Keep your review cards here as is] ... -->
        </div>
    </div>

    <hr>
    <button id="backButton" onclick="window.history.back()">
        <i class="fas fa-arrow-left"></i>
    </button>

    <!-- Footer -->
    <footer>
        <div class="container-fluid padding">
            <div class="row text-center">
                <div class="col-md-4">
                    <hr class="light">
                    <img src="img/logo.png" alt="">
                    <hr class="light">
                    <p>042-123-456</p>
                    <p>@gmail.com</p>
                    <p>Street 104 north</p>
                    <p>Demo city,00000</p>
                </div>
                <div class="col-md-4">
                    <hr class="light">
                    <h5>Our hours</h5>
                    <hr class="light">
                    <p>Monday: 9am to 5pm</p>
                    <p>Saturday: 10am to 4pm</p>
                    <p>Sunday: Closed</p>
                </div>
                <div class="col-md-4">
                    <hr class="light">
                    <h5>Service Areas</h5>
                    <hr class="light">
                    <p>Demo city,00000</p>
                    <p>Demo city,00000</p>
                    <p>Demo city,00000</p>
                    <p>Demo city,00000</p>
                </div>
            </div>
            <div class="col-12 text-center">
                <hr class="light">
                <h5>&copy; Texkiofficial</h5>
            </div>
        </div>
    </footer>

    <!-- Floating Button -->
    <button id="stickyButton" onclick="window.location.href='3d.html'; return false;">Start 3D Modeling!</button>

    <!-- Venue Section -->
    <div class="container mt-4">
        <h2 class="text-center mb-4">Wedding Venues</h2>
        
        <!-- Filter Section -->
        <div class="col-12 filter-container p-4 mb-4">
            <h5 class="mt-3">Filters</h5>
            <hr>
            <!-- City Filter -->
            <div class="mb-3">
                <h6>City</h6>
                <div class="row">
                    <div class="col-md-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="lahore">
                            <label class="form-check-label" for="lahore">Lahore</label>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="karachi">
                            <label class="form-check-label" for="karachi">Karachi</label>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="islamabad">
                            <label class="form-check-label" for="islamabad">Islamabad</label>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="rawalpindi">
                            <label class="form-check-label" for="rawalpindi">Rawalpindi</label>
                        </div>
                    </div>
                </div>
            </div>
            <hr>

            <!-- Area Filter -->
            <div class="mb-3">
                <h6>Area</h6>
                <input type="text" class="form-control" id="areaSearch" placeholder="Search by area (e.g., DHA, Gulberg)">
            </div>
            <hr>

            <!-- Price Filter -->
            <div class="mb-3">
                <h6>Price Range (per event)</h6>
                <div class="row">
                    <div class="col-md-4">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="price1">
                            <label class="form-check-label" for="price1">Under PKR 2,000</label>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="price2">
                            <label class="form-check-label" for="price2">PKR 2,000 - 3,000</label>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="price3">
                            <label class="form-check-label" for="price3">PKR 3,000 - 4,000</label>
                        </div>
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-4">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="price4">
                            <label class="form-check-label" for="price4">PKR 4,000 - 5,000</label>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="price5">
                            <label class="form-check-label" for="price5">Above PKR 5,000</label>
                        </div>
                    </div>
                </div>
            </div>
            <hr>

            <!-- Timing Filter -->
            <div class="mb-3">
                <h6>Timing Preference</h6>
                <div class="row">
                    <div class="col-md-4">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="morning">
                            <label class="form-check-label" for="morning">Morning (6 AM - 12 PM)</label>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="afternoon">
                            <label class="form-check-label" for="afternoon">Afternoon (12 PM - 5 PM)</label>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="evening">
                            <label class="form-check-label" for="evening">Evening (5 PM - 11 PM)</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="venues-container row">
            <!-- Venues will be dynamically loaded here -->
        </div>
    </div>

    <!-- Booking Modal -->
    <div class="modal fade" id="bookingModal" tabindex="-1" aria-labelledby="bookingModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="bookingModalLabel">Book Venue</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="bookingForm">
                        <input type="hidden" id="venueId">
                        <div class="mb-3">
                            <label for="bookingDate" class="form-label">Event Date</label>
                            <input type="date" class="form-control" id="bookingDate" required>
                        </div>
                        <div class="mb-3">
                            <label for="guestCount" class="form-label">Number of Guests</label>
                            <input type="number" class="form-control" id="guestCount" min="1" required>
                        </div>
                        <div class="mb-3">
                            <label for="eventType" class="form-label">Event Type</label>
                            <select class="form-select" id="eventType" required>
                                <option value="">Select Event Type</option>
                                <option value="wedding">Wedding</option>
                                <option value="reception">Reception</option>
                                <option value="engagement">Engagement</option>
                                <option value="mehendi">Mehendi</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="additionalNotes" class="form-label">Additional Notes</label>
                            <textarea class="form-control" id="additionalNotes" rows="3"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="confirmBooking">Book Now</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
    <script src="js/venues.js"></script>
    <script src="AOS.js"></script>
    <script src="progressbar.js"></script>
    <script src="dropdown.js"></script>
    <script src="js/auth.js"></script>
    <script>
        AOS.init();

        document.addEventListener("DOMContentLoaded", async () => {
            // FALLING STARS
            const starsContainer = document.getElementById('stars');
            for (let i = 0; i < 100; i++) {
                const star = document.createElement('div');
                star.classList.add('star');
                const size = Math.random() * 3 + 1;
                star.style.width = `${size}px`;
                star.style.height = `${size}px`;
                star.style.left = `${Math.random() * 100}vw`;
                star.style.animationDuration = `${Math.random() * 5 + 5}s`;
                star.style.animationDelay = `-${Math.random() * 5}s`;
                starsContainer.appendChild(star);
            }

            // TOGGLE TEXT
            document.querySelectorAll('.toggleButton').forEach(button => {
                button.addEventListener('click', function () {
                    const text = this.previousElementSibling;
                    if (text.style.visibility === "hidden") {
                        text.style.visibility = "visible";
                        this.textContent = "Hide Text";
                    } else {
                        text.style.visibility = "hidden";
                        this.textContent = "Show Text";
                    }
                });
            });

            // FETCH USER PROFILE
            const token = localStorage.getItem("token");

            try {
                const res = await fetch("http://localhost:4201/api/me", {
                    headers: { Authorization: "Bearer " + token }
                });
                const data = await res.json();
                if (!res.ok) throw new Error(data.message || "Failed to fetch user data");
                document.getElementById("user-info").innerHTML = `
                    <h5>${data.fullName}</h5>
                    <p><strong>Email:</strong> ${data.email}</p>
                    <p><strong>Gender:</strong> ${data.gender}</p>
                    <p><strong>Bio:</strong> ${data.bio}</p>
                    <p><strong>Location:</strong> ${data.addressArea}, ${data.addressCity}, ${data.addressCountry} - ${data.addressZip}</p>
                    <p><strong>Date of Birth:</strong> ${new Date(data.dateOfBirth).toLocaleDateString()}</p>
                    <p><strong>Status:</strong> ${data.isBanned ? "Banned" : "Active"}</p>
                `;
            } catch (err) {
                document.getElementById("user-info").innerHTML = `<p class="text-danger">${err.message}</p>`;
            }

            // FETCH VENUES
            try {
                const res = await fetch("http://localhost:4201/api/venues", {
                    headers: { Authorization: "Bearer " + token }
                });
                const data = await res.json();
                if (!res.ok) throw new Error(data.message || "Failed to load venues");

                const container = document.getElementById("venue-container");
                container.innerHTML = "";
                data.venues.forEach(venue => {
                    const card = document.createElement("div");
                    card.className = "card mb-3 shadow-sm";
                    card.innerHTML = `
                        <div class="card-body">
                            <h5 class="card-title">${venue.name}</h5>
                            <p class="card-text">${venue.location || "Location not available"}</p>
                            <p class="card-text"><small class="text-muted">Capacity: ${venue.capacity || "N/A"}</small></p>
                        </div>
                    `;
                    container.appendChild(card);
                });
            } catch (err) {
                document.getElementById("venue-container").innerHTML = "<p class='text-danger'>" + err.message + "</p>";
            }

            // Require authentication for venue details page
            Auth.requireAuth();
        });
    </script>
</body>

</html>